<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èƒŒè¯µç¥å™¨ v0.4 (æ²‰æµ¸ç‰ˆ)</title>
    <style>
        :root {
            --bg-color: #1e1e1e;
            --text-color: #d4d4d4;
            --accent-color: #4ec9b0;
            --blur-bg: #4a4a4a;
            --sidebar-width: 50%; /* é»˜è®¤å¯¹åŠåˆ† */
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            height: 100vh;
            box-sizing: border-box;
            transition: padding 0.3s;
        }

        /* é¡¶éƒ¨æ§åˆ¶æ  */
        .controls {
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0; /* é˜²æ­¢è¢«æŒ¤å‹ */
        }

        .header-left {
            display: flex;
            flex-direction: column;
        }

        h2 {
            margin: 0;
            color: var(--accent-color);
            font-size: 1.2rem;
            letter-spacing: 1px;
        }
        
        .hint { font-size: 0.8rem; opacity: 0.6; margin-top: 4px; }

        .btn-group {
            display: flex;
            gap: 10px;
        }

        button {
            border: none;
            padding: 8px 16px;
            color: #1e1e1e;
            font-weight: bold;
            cursor: pointer;
            border-radius: 4px;
            transition: opacity 0.2s, transform 0.1s;
            font-size: 14px;
        }

        button:active { transform: scale(0.98); }
        button:hover { opacity: 0.9; }

        /* åŠŸèƒ½æŒ‰é’®é¢œè‰²åŒºåˆ† */
        .btn-reset { background: #ce9178; }
        .btn-toggle { background: #569cd6; color: white; }
        .btn-layout { background: var(--accent-color); }

        /* === å¸ƒå±€æ ¸å¿ƒ === */
        .container {
            display: flex;
            gap: 20px;
            flex: 1;
            min-height: 0; /* å…³é”®ï¼šé˜²æ­¢Flexå­å…ƒç´ æº¢å‡º */
            position: relative;
        }

        /* å·¦ä¾§è¾“å…¥æ¡† */
        .input-box {
            flex: 0 0 var(--sidebar-width); /* å›ºå®šå®½åº¦æˆ–æ¯”ä¾‹ */
            display: flex;
            flex-direction: column;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            background: #252526;
            transition: all 0.4s cubic-bezier(0.25, 1, 0.5, 1); /* ä¸æ»‘åŠ¨ç”» */
            overflow: hidden;
            opacity: 1;
        }

        /* å½“å·¦ä¾§éšè—æ—¶ */
        .input-box.hidden {
            flex: 0 0 0; /* å®½åº¦å˜0 */
            padding: 20px 0; /* æ¨ªå‘paddingå˜0 */
            border-width: 0;
            opacity: 0;
            margin-right: -20px; /* æŠµæ¶ˆgap */
        }

        /* å³ä¾§é¢„è§ˆæ¡† */
        .preview-box {
            flex: 1; /* è‡ªåŠ¨å¡«æ»¡å‰©ä½™ç©ºé—´ */
            border: 1px solid #333;
            border-radius: 8px;
            padding: 40px; /* é˜…è¯»æ¨¡å¼ä¸‹è¾¹è·å¤§ä¸€ç‚¹æ›´èˆ’æœ */
            background: #252526;
            overflow-y: auto;
            display: block; 
            font-size: 20px; /* å…¨å±æ¨¡å¼å­—ä½“åŠ å¤§ */
            line-height: 1.9;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-width: 100%; /* é˜²æ­¢æ’‘å¼€ */
        }

        textarea {
            flex: 1;
            background: transparent;
            color: var(--text-color);
            border: none;
            resize: none;
            outline: none;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.6;
            width: 100%;
        }

        /* === æ ·å¼ç³»ç»Ÿ === */
        /* æ¨¡ç³Šå— */
        .spoiler {
            background-color: var(--blur-bg);
            color: transparent;
            text-shadow: 0 0 12px rgba(255,255,255,0.4);
            border-radius: 4px;
            padding: 0 5px;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
            -webkit-box-decoration-break: clone;
            box-decoration-break: clone;
        }

        .spoiler.revealed {
            background-color: rgba(78, 201, 176, 0.15);
            color: var(--accent-color);
            text-shadow: none;
            border-bottom: 2px solid var(--accent-color);
            border-radius: 0;
        }

        /* æçº²æ¨¡å¼ (Hardcore) */
        .hardcore-mode {
            color: transparent !important;
            text-shadow: none !important;
        }
        .hardcore-mode .spoiler {
            background-color: transparent !important;
            box-shadow: none !important;
            border-bottom: none !important;
            pointer-events: none;
        }
        /* æçº²æ¨¡å¼ä¸‹æ ‡é¢˜å¯è§ */
        .hardcore-mode h3 {
            color: var(--accent-color) !important;
            opacity: 0.8;
            border-bottom: 1px dashed #333;
            padding-bottom: 10px;
        }
    </style>
</head>
<body>

    <div class="controls">
        <div class="header-left">
            <h2>Markdown èƒŒè¯µæœº</h2>
            <span class="hint">å·¦å†™å³èƒŒï¼Œå…¨å±ä¸“æ³¨ã€‚</span>
        </div>
        <div class="btn-group">
            <button class="btn-layout" onclick="toggleLayout()">â†”ï¸ åˆ‡æ¢å…¨å±</button>
            <button class="btn-toggle" onclick="toggleHardcore()">ğŸ”¥ æçº²æ¨¡å¼</button>
            <button class="btn-reset" onclick="resetAll()">ğŸ™ˆ å…¨éƒ¨éšè—</button>
        </div>
    </div>

    <div class="container">
        <div class="input-box" id="inputBox">
            <textarea id="inputArea" placeholder="è¾“å…¥ç¬”è®°...&#10;&#10;ä½¿ç”¨ **é‡ç‚¹** æ¥æ¨¡ç³Šå†…å®¹ã€‚&#10;ç‚¹å‡»ä¸Šæ–¹â€œåˆ‡æ¢å…¨å±â€éšè—æ­¤æ¡†ã€‚"></textarea>
        </div>

        <div class="box preview-box" id="preview"></div>
    </div>

    <script>
        const inputArea = document.getElementById('inputArea');
        const preview = document.getElementById('preview');
        const inputBox = document.getElementById('inputBox');

        // å®æ—¶æ¸²æŸ“
        inputArea.addEventListener('input', () => {
            render(inputArea.value);
            // è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ï¼Œé˜²æ‰‹æ»‘åˆ·æ–°
            localStorage.setItem('reciteContent', inputArea.value);
        });

        function render(text) {
            let html = text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
            
            // ç®€å•çš„ Markdown æ ‡é¢˜æ”¯æŒ
            html = html.replace(/^## (.*$)/gim, '<h3 style="margin:1.5em 0 0.8em; color:#4ec9b0; font-size:1.4em;">$1</h3>');
            
            // æ¨¡ç³Šé€»è¾‘
            html = html.replace(/\*\*(.*?)\*\*/g, '<span class="spoiler" onclick="toggleReveal(this)">$1</span>');
            
            preview.innerHTML = html;
        }

        function toggleReveal(element) {
            element.classList.toggle('revealed');
        }

        function resetAll() {
            document.querySelectorAll('.spoiler').forEach(el => el.classList.remove('revealed'));
        }

        // åˆ‡æ¢æçº²æ¨¡å¼
        function toggleHardcore() {
            preview.classList.toggle('hardcore-mode');
        }

        // åˆ‡æ¢å…¨å±å¸ƒå±€
        function toggleLayout() {
            inputBox.classList.toggle('hidden');
        }

        // é¡µé¢åŠ è½½æ—¶æ¢å¤å†…å®¹
        window.onload = function() {
            const saved = localStorage.getItem('reciteContent');
            if (saved) {
                inputArea.value = saved;
                render(saved);
            } else {
                const defaultText = "## å“²å­¦åŸºæœ¬é—®é¢˜\n1. å­˜åœ¨å’Œæ€ç»´ã€ç‰©è´¨å’Œæ„è¯†**è°ä¸ºæœ¬æº**çš„é—®é¢˜ã€‚\n2. ç‚¹å‡»å³ä¸Šè§’çš„**åˆ‡æ¢å…¨å±**æŒ‰é’®ï¼ŒæŠŠå·¦è¾¹è¿™ä¸ªè¾“å…¥æ¡†æ”¶èµ·æ¥ï¼Œå¼€å§‹ä¸“å¿ƒèƒŒä¹¦å§ï¼";
                inputArea.value = defaultText;
                render(defaultText);
            }
        }
    </script>
</body>
</html>